
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plotting/compute_extract.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

  .. container:: binder-badge

    .. image:: images/binder_badge_logo.svg
      :target: https://mybinder.org/v2/gh/theislab/squidpy_notebooks/master?filepath=docs/source/auto_examples/plotting/compute_extract.ipynb
      :alt: Launch binder
      :width: 150 px

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plotting_compute_extract.py:

Plot features in adata.obsm
---------------------------

This example shows how to use :func:`squidpy.pl.extract` to plot features in :attr:`anndata.AnnData.obsm`.

This function is useful when a feature matrix is saved separately there and its features
are therefore not accessible via standard :mod:`scanpy` plotting.

.. seealso::

    See :ref:`sphx_glr_auto_examples_image_compute_summary_features.py` for computing an example of such features.

.. GENERATED FROM PYTHON SOURCE LINES 15-21

.. code-block:: default

    import scanpy as sc
    import squidpy as sq

    adata = sq.datasets.slideseqv2()
    adata





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    AnnData object with n_obs × n_vars = 41786 × 4000
        obs: 'barcode', 'x', 'y', 'n_genes_by_counts', 'log1p_n_genes_by_counts', 'total_counts', 'log1p_total_counts', 'pct_counts_in_top_50_genes', 'pct_counts_in_top_100_genes', 'pct_counts_in_top_200_genes', 'pct_counts_in_top_500_genes', 'total_counts_MT', 'log1p_total_counts_MT', 'pct_counts_MT', 'n_counts', 'leiden', 'cluster'
        var: 'MT', 'n_cells_by_counts', 'mean_counts', 'log1p_mean_counts', 'pct_dropout_by_counts', 'total_counts', 'log1p_total_counts', 'n_cells', 'highly_variable', 'highly_variable_rank', 'means', 'variances', 'variances_norm'
        uns: 'cluster_colors', 'hvg', 'leiden', 'leiden_colors', 'neighbors', 'pca', 'spatial_neighbors', 'umap'
        obsm: 'X_pca', 'X_umap', 'deconvolution_results', 'spatial'
        varm: 'PCs'
        obsp: 'connectivities', 'distances', 'spatial_connectivities', 'spatial_distances'



.. GENERATED FROM PYTHON SOURCE LINES 22-24

In this dataset, we have saved deconvolution results in `adata.obsm` and we
would like to plot them with :func:`scanpy.pl.spatial`.

.. GENERATED FROM PYTHON SOURCE LINES 24-26

.. code-block:: default

    adata.obsm["deconvolution_results"].head(10)






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>Interneurons</th>
          <th>Subiculum_Entorhinal_cl2</th>
          <th>Subiculum_Entorhinal_cl3</th>
          <th>DentatePyramids</th>
          <th>CA1_CA2_CA3_Subiculum</th>
          <th>Mural</th>
          <th>Astrocytes</th>
          <th>Oligodendrocytes</th>
          <th>Polydendrocytes</th>
          <th>Microglia</th>
          <th>Ependymal</th>
          <th>Endothelial_Tip</th>
          <th>Neurogenesis</th>
          <th>Endothelial_Stalk</th>
          <th>barcode</th>
          <th>max_cell_type</th>
          <th>maxval</th>
          <th>thresh_ct</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>AACGTCATAATCGT</th>
          <td>0.113249</td>
          <td>0.203010</td>
          <td>0.086060</td>
          <td>0.247319</td>
          <td>0.153769</td>
          <td>0.002455</td>
          <td>0.072134</td>
          <td>0.022327</td>
          <td>0.008712</td>
          <td>0.065562</td>
          <td>0.003853</td>
          <td>0.000000</td>
          <td>0.000000</td>
          <td>0.021550</td>
          <td>AACGTCATAATCGT</td>
          <td>4</td>
          <td>0.247319</td>
          <td>0.000000</td>
        </tr>
        <tr>
          <th>TACTTTAGCGCAGT</th>
          <td>0.055718</td>
          <td>0.077973</td>
          <td>0.048517</td>
          <td>0.187755</td>
          <td>0.195889</td>
          <td>0.040198</td>
          <td>0.126317</td>
          <td>0.071605</td>
          <td>0.052353</td>
          <td>0.013668</td>
          <td>0.016075</td>
          <td>0.044060</td>
          <td>0.012159</td>
          <td>0.057714</td>
          <td>TACTTTAGCGCAGT</td>
          <td>5</td>
          <td>0.195889</td>
          <td>0.000000</td>
        </tr>
        <tr>
          <th>CATGCCTGGGTTCG</th>
          <td>0.108751</td>
          <td>0.228845</td>
          <td>0.109581</td>
          <td>0.246070</td>
          <td>0.115723</td>
          <td>0.006306</td>
          <td>0.071186</td>
          <td>0.015768</td>
          <td>0.000000</td>
          <td>0.059735</td>
          <td>0.000000</td>
          <td>0.013702</td>
          <td>0.000000</td>
          <td>0.024332</td>
          <td>CATGCCTGGGTTCG</td>
          <td>4</td>
          <td>0.246070</td>
          <td>0.000000</td>
        </tr>
        <tr>
          <th>TCGATATGGCACAA</th>
          <td>0.108163</td>
          <td>0.029694</td>
          <td>0.112905</td>
          <td>0.172960</td>
          <td>0.122573</td>
          <td>0.014295</td>
          <td>0.065901</td>
          <td>0.031834</td>
          <td>0.096153</td>
          <td>0.034155</td>
          <td>0.094124</td>
          <td>0.065322</td>
          <td>0.011114</td>
          <td>0.040808</td>
          <td>TCGATATGGCACAA</td>
          <td>4</td>
          <td>0.172960</td>
          <td>0.000000</td>
        </tr>
        <tr>
          <th>TTATCTGACGAAGC</th>
          <td>0.065790</td>
          <td>0.236463</td>
          <td>0.012458</td>
          <td>0.233441</td>
          <td>0.145091</td>
          <td>0.014810</td>
          <td>0.097935</td>
          <td>0.052590</td>
          <td>0.023642</td>
          <td>0.008578</td>
          <td>0.014275</td>
          <td>0.058715</td>
          <td>0.000000</td>
          <td>0.036213</td>
          <td>TTATCTGACGAAGC</td>
          <td>2</td>
          <td>0.236463</td>
          <td>0.000000</td>
        </tr>
        <tr>
          <th>GATGCGACTCCTCG</th>
          <td>0.000000</td>
          <td>0.000000</td>
          <td>0.000000</td>
          <td>0.222606</td>
          <td>0.705572</td>
          <td>0.042319</td>
          <td>0.009459</td>
          <td>0.000000</td>
          <td>0.002753</td>
          <td>0.009457</td>
          <td>0.000000</td>
          <td>0.000000</td>
          <td>0.004932</td>
          <td>0.002902</td>
          <td>GATGCGACTCCTCG</td>
          <td>5</td>
          <td>0.705572</td>
          <td>0.705572</td>
        </tr>
        <tr>
          <th>ACGGATGTTCCGAT</th>
          <td>0.000000</td>
          <td>0.000000</td>
          <td>0.000000</td>
          <td>0.037305</td>
          <td>0.078873</td>
          <td>0.014507</td>
          <td>0.032262</td>
          <td>0.500225</td>
          <td>0.099139</td>
          <td>0.147571</td>
          <td>0.013209</td>
          <td>0.023574</td>
          <td>0.010208</td>
          <td>0.043127</td>
          <td>ACGGATGTTCCGAT</td>
          <td>8</td>
          <td>0.500225</td>
          <td>0.500225</td>
        </tr>
        <tr>
          <th>TCTCATGGGTGGGA</th>
          <td>0.011898</td>
          <td>0.000000</td>
          <td>0.000000</td>
          <td>0.114613</td>
          <td>0.089905</td>
          <td>0.010118</td>
          <td>0.411598</td>
          <td>0.188769</td>
          <td>0.034367</td>
          <td>0.059139</td>
          <td>0.000000</td>
          <td>0.029453</td>
          <td>0.017615</td>
          <td>0.032526</td>
          <td>TCTCATGGGTGGGA</td>
          <td>7</td>
          <td>0.411598</td>
          <td>0.411598</td>
        </tr>
        <tr>
          <th>ACCGGAACTTCTTC</th>
          <td>0.016862</td>
          <td>0.000000</td>
          <td>0.000000</td>
          <td>0.017110</td>
          <td>0.070573</td>
          <td>0.017013</td>
          <td>0.006445</td>
          <td>0.091637</td>
          <td>0.034633</td>
          <td>0.022682</td>
          <td>0.659986</td>
          <td>0.029675</td>
          <td>0.009862</td>
          <td>0.023523</td>
          <td>ACCGGAACTTCTTC</td>
          <td>11</td>
          <td>0.659986</td>
          <td>0.659986</td>
        </tr>
        <tr>
          <th>ACAGGGTTTATCGA</th>
          <td>0.012235</td>
          <td>0.000000</td>
          <td>0.010678</td>
          <td>0.138919</td>
          <td>0.723275</td>
          <td>0.026109</td>
          <td>0.029469</td>
          <td>0.003275</td>
          <td>0.003829</td>
          <td>0.011391</td>
          <td>0.011063</td>
          <td>0.000000</td>
          <td>0.014785</td>
          <td>0.014970</td>
          <td>ACAGGGTTTATCGA</td>
          <td>5</td>
          <td>0.723275</td>
          <td>0.723275</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 27-30

Squidpy provides an easy wrapper that creates a temporary copy of the
feature matrix and pass it to :attr:`anndata.AnnData.obs` and makes it therefore accessible
for Scanpy plotting.

.. GENERATED FROM PYTHON SOURCE LINES 30-35

.. code-block:: default

    sc.pl.spatial(
        sq.pl.extract(adata, "deconvolution_results"),
        color=["Astrocytes", "Mural", "CA1_CA2_CA3_Subiculum"],
        spot_size=30,
    )



.. image:: /auto_examples/plotting/images/sphx_glr_compute_extract_001.png
    :alt: Astrocytes, Mural, CA1_CA2_CA3_Subiculum
    :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  21.832 seconds)

**Estimated memory usage:**  719 MB


.. _sphx_glr_download_auto_examples_plotting_compute_extract.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: compute_extract.py <compute_extract.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: compute_extract.ipynb <compute_extract.ipynb>`
