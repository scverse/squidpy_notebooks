
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/graph/compute_ripley.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

  .. container:: binder-badge

    .. image:: images/binder_badge_logo.svg
      :target: https://mybinder.org/v2/gh/scverse/squidpy_notebooks/main?filepath=docs/source/auto_examples/graph/compute_ripley.ipynb
      :alt: Launch binder
      :width: 150 px

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_graph_compute_ripley.py:

Compute Ripley's statistics
---------------------------

This example shows how to compute the Ripley's L function.

The Ripley's L function is a descriptive statistics generally used
to determine whether points have a random, dispersed or clustered distribution
pattern at certain scale.
The Ripley's L is a variance-normalized version of the Ripley's K statistic.

.. seealso::

    See :ref:`sphx_glr_auto_examples_graph_compute_co_occurrence.py` for
    another score to describe spatial patterns with :func:`squidpy.gr.co_occurrence`.

.. GENERATED FROM PYTHON SOURCE LINES 18-23

.. code-block:: default

    import squidpy as sq

    adata = sq.datasets.slideseqv2()
    adata





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

      0%|          | 0.00/251M [00:00<?, ?B/s]      0%|          | 72.0k/251M [00:00<06:09, 713kB/s]      0%|          | 296k/251M [00:00<02:45, 1.59MB/s]      0%|          | 992k/251M [00:00<01:04, 4.07MB/s]      1%|          | 1.90M/251M [00:00<00:41, 6.27MB/s]      1%|          | 2.13M/251M [00:00<01:29, 2.92MB/s]      2%|1         | 4.07M/251M [00:00<00:37, 6.83MB/s]      2%|1         | 4.70M/251M [00:00<00:42, 6.08MB/s]      2%|2         | 6.26M/251M [00:01<00:30, 8.32MB/s]      3%|2         | 7.05M/251M [00:01<00:30, 8.33MB/s]      3%|3         | 8.09M/251M [00:01<00:28, 8.98MB/s]      4%|3         | 9.07M/251M [00:01<00:27, 9.33MB/s]      4%|4         | 10.1M/251M [00:01<00:26, 9.66MB/s]      4%|4         | 11.1M/251M [00:01<00:25, 9.80MB/s]      5%|4         | 12.0M/251M [00:01<00:25, 9.71MB/s]      5%|5         | 13.0M/251M [00:01<00:25, 9.77MB/s]      6%|5         | 14.0M/251M [00:01<00:25, 9.86MB/s]      6%|5         | 14.9M/251M [00:01<00:25, 9.76MB/s]      6%|6         | 15.9M/251M [00:02<00:24, 9.99MB/s]      7%|6         | 17.1M/251M [00:02<00:23, 10.5MB/s]      7%|7         | 18.2M/251M [00:02<00:22, 10.7MB/s]      8%|7         | 19.1M/251M [00:02<00:23, 10.4MB/s]      8%|8         | 20.2M/251M [00:02<00:22, 10.6MB/s]      8%|8         | 21.2M/251M [00:02<00:23, 10.4MB/s]      9%|8         | 22.3M/251M [00:02<00:22, 10.7MB/s]      9%|9         | 23.3M/251M [00:02<00:22, 10.5MB/s]     10%|9         | 23.9M/251M [00:02<00:27, 8.80MB/s]     10%|9         | 24.9M/251M [00:03<00:25, 9.24MB/s]     10%|#         | 25.3M/251M [00:03<00:31, 7.52MB/s]     10%|#         | 26.2M/251M [00:03<00:28, 8.30MB/s]     11%|#         | 27.1M/251M [00:03<00:27, 8.52MB/s]     11%|#1        | 27.9M/251M [00:03<00:27, 8.51MB/s]     11%|#1        | 28.8M/251M [00:03<00:27, 8.58MB/s]     12%|#1        | 29.6M/251M [00:03<00:27, 8.55MB/s]     12%|#2        | 30.4M/251M [00:03<00:27, 8.53MB/s]     12%|#2        | 31.3M/251M [00:03<00:26, 8.68MB/s]     13%|#2        | 32.1M/251M [00:03<00:26, 8.77MB/s]     13%|#3        | 33.1M/251M [00:04<00:24, 9.20MB/s]     14%|#3        | 34.0M/251M [00:04<00:24, 9.25MB/s]     14%|#3        | 34.9M/251M [00:04<00:24, 9.32MB/s]     14%|#4        | 35.9M/251M [00:04<00:23, 9.52MB/s]     15%|#4        | 36.9M/251M [00:04<00:23, 9.65MB/s]     15%|#4        | 37.7M/251M [00:04<00:25, 8.66MB/s]     15%|#5        | 38.5M/251M [00:04<00:25, 8.77MB/s]     16%|#5        | 39.5M/251M [00:04<00:24, 9.07MB/s]     16%|#6        | 40.5M/251M [00:04<00:23, 9.51MB/s]     17%|#6        | 41.6M/251M [00:04<00:21, 10.0MB/s]     17%|#6        | 42.5M/251M [00:05<00:21, 10.0MB/s]     17%|#7        | 43.4M/251M [00:05<00:22, 9.80MB/s]     18%|#7        | 44.4M/251M [00:05<00:22, 9.77MB/s]     18%|#8        | 45.4M/251M [00:05<00:21, 9.96MB/s]     18%|#8        | 46.3M/251M [00:05<00:22, 9.69MB/s]     19%|#8        | 47.3M/251M [00:05<00:21, 9.91MB/s]     19%|#9        | 48.2M/251M [00:05<00:21, 9.76MB/s]     19%|#9        | 48.9M/251M [00:05<00:23, 9.00MB/s]     20%|#9        | 49.9M/251M [00:05<00:22, 9.24MB/s]     20%|##        | 50.4M/251M [00:05<00:25, 8.14MB/s]     20%|##        | 51.3M/251M [00:06<00:25, 8.29MB/s]     21%|##        | 51.9M/251M [00:06<00:27, 7.73MB/s]     21%|##        | 52.7M/251M [00:06<00:26, 7.86MB/s]     21%|##1       | 53.5M/251M [00:06<00:25, 8.03MB/s]     22%|##1       | 54.3M/251M [00:06<00:26, 7.88MB/s]     22%|##1       | 55.1M/251M [00:06<00:25, 8.19MB/s]     22%|##2       | 55.9M/251M [00:06<00:25, 8.04MB/s]     23%|##2       | 56.8M/251M [00:06<00:24, 8.31MB/s]     23%|##2       | 57.6M/251M [00:06<00:24, 8.31MB/s]     23%|##3       | 58.3M/251M [00:07<00:24, 8.15MB/s]     24%|##3       | 59.2M/251M [00:07<00:23, 8.57MB/s]     24%|##3       | 60.0M/251M [00:07<00:24, 8.21MB/s]     24%|##4       | 60.9M/251M [00:07<00:23, 8.44MB/s]     25%|##4       | 61.6M/251M [00:07<00:24, 8.22MB/s]     25%|##4       | 62.3M/251M [00:07<00:25, 7.80MB/s]     25%|##5       | 63.2M/251M [00:07<00:23, 8.26MB/s]     25%|##5       | 64.0M/251M [00:07<00:24, 8.15MB/s]     26%|##5       | 64.7M/251M [00:07<00:24, 8.04MB/s]     26%|##6       | 65.5M/251M [00:07<00:24, 8.06MB/s]     26%|##6       | 66.3M/251M [00:08<00:23, 8.14MB/s]     27%|##6       | 67.1M/251M [00:08<00:23, 8.32MB/s]     27%|##7       | 68.0M/251M [00:08<00:22, 8.37MB/s]     27%|##7       | 68.8M/251M [00:08<00:22, 8.34MB/s]     28%|##7       | 69.6M/251M [00:08<00:22, 8.63MB/s]     28%|##8       | 70.4M/251M [00:08<00:22, 8.49MB/s]     28%|##8       | 71.3M/251M [00:08<00:22, 8.57MB/s]     29%|##8       | 72.0M/251M [00:08<00:22, 8.26MB/s]     29%|##8       | 72.7M/251M [00:08<00:23, 8.11MB/s]     29%|##9       | 73.5M/251M [00:08<00:23, 8.08MB/s]     30%|##9       | 74.4M/251M [00:09<00:22, 8.27MB/s]     30%|##9       | 75.1M/251M [00:09<00:23, 7.86MB/s]     30%|###       | 76.1M/251M [00:09<00:21, 8.71MB/s]     31%|###       | 76.8M/251M [00:09<00:22, 8.31MB/s]     31%|###       | 77.5M/251M [00:09<00:22, 8.00MB/s]     31%|###1      | 78.1M/251M [00:09<00:25, 7.20MB/s]     31%|###1      | 78.2M/251M [00:09<00:39, 4.60MB/s]     31%|###1      | 78.5M/251M [00:09<00:49, 3.67MB/s]     31%|###1      | 78.9M/251M [00:10<00:58, 3.10MB/s]     32%|###1      | 79.3M/251M [00:10<01:03, 2.83MB/s]     32%|###1      | 79.7M/251M [00:10<01:08, 2.65MB/s]     32%|###1      | 80.0M/251M [00:10<01:06, 2.70MB/s]     32%|###1      | 80.3M/251M [00:10<01:06, 2.68MB/s]     32%|###1      | 80.4M/251M [00:11<02:08, 1.39MB/s]     32%|###2      | 81.0M/251M [00:11<01:29, 1.99MB/s]     32%|###2      | 81.3M/251M [00:11<01:34, 1.88MB/s]     33%|###2      | 81.8M/251M [00:11<01:15, 2.35MB/s]     33%|###2      | 81.9M/251M [00:11<01:23, 2.13MB/s]     33%|###2      | 82.6M/251M [00:11<00:54, 3.27MB/s]     33%|###3      | 83.2M/251M [00:11<00:42, 4.13MB/s]     33%|###3      | 84.0M/251M [00:11<00:35, 4.99MB/s]     34%|###3      | 84.7M/251M [00:12<00:30, 5.65MB/s]     34%|###3      | 85.2M/251M [00:12<00:30, 5.71MB/s]     34%|###4      | 85.8M/251M [00:12<00:30, 5.62MB/s]     34%|###4      | 86.4M/251M [00:12<00:28, 6.02MB/s]     35%|###4      | 87.1M/251M [00:12<00:29, 5.79MB/s]     35%|###4      | 87.9M/251M [00:12<00:26, 6.42MB/s]     35%|###5      | 88.7M/251M [00:12<00:24, 6.88MB/s]     36%|###5      | 89.5M/251M [00:12<00:22, 7.38MB/s]     36%|###5      | 90.2M/251M [00:12<00:22, 7.37MB/s]     36%|###6      | 91.1M/251M [00:12<00:21, 7.94MB/s]     37%|###6      | 91.8M/251M [00:13<00:21, 7.76MB/s]     37%|###6      | 92.6M/251M [00:13<00:20, 7.93MB/s]     37%|###7      | 93.4M/251M [00:13<00:20, 7.92MB/s]     37%|###7      | 94.2M/251M [00:13<00:21, 7.78MB/s]     38%|###7      | 95.1M/251M [00:13<00:20, 8.17MB/s]     38%|###8      | 95.8M/251M [00:13<00:21, 7.61MB/s]     38%|###8      | 96.5M/251M [00:13<00:21, 7.71MB/s]     39%|###8      | 97.4M/251M [00:13<00:19, 8.22MB/s]     39%|###9      | 98.3M/251M [00:13<00:18, 8.49MB/s]     39%|###9      | 99.2M/251M [00:14<00:18, 8.76MB/s]     40%|###9      | 100M/251M [00:14<00:18, 8.52MB/s]      40%|####      | 101M/251M [00:14<00:21, 7.32MB/s]     40%|####      | 102M/251M [00:14<00:20, 7.78MB/s]     41%|####      | 102M/251M [00:14<00:19, 7.86MB/s]     41%|####1     | 103M/251M [00:14<00:18, 8.28MB/s]     41%|####1     | 104M/251M [00:14<00:19, 7.78MB/s]     42%|####1     | 105M/251M [00:14<00:19, 7.73MB/s]     42%|####1     | 105M/251M [00:14<00:18, 8.16MB/s]     42%|####2     | 106M/251M [00:14<00:18, 8.16MB/s]     43%|####2     | 107M/251M [00:15<00:18, 8.25MB/s]     43%|####2     | 108M/251M [00:15<00:17, 8.40MB/s]     43%|####3     | 109M/251M [00:15<00:17, 8.67MB/s]     44%|####3     | 110M/251M [00:15<00:16, 8.84MB/s]     44%|####3     | 111M/251M [00:15<00:17, 8.61MB/s]     44%|####4     | 111M/251M [00:15<00:17, 8.47MB/s]     45%|####4     | 112M/251M [00:15<00:16, 8.77MB/s]     45%|####4     | 113M/251M [00:15<00:16, 8.67MB/s]     45%|####5     | 114M/251M [00:15<00:16, 8.59MB/s]     46%|####5     | 114M/251M [00:15<00:18, 7.95MB/s]     46%|####5     | 115M/251M [00:16<00:18, 7.84MB/s]     46%|####6     | 116M/251M [00:16<00:17, 8.01MB/s]     47%|####6     | 117M/251M [00:16<00:17, 8.17MB/s]     47%|####6     | 117M/251M [00:16<00:19, 7.24MB/s]     47%|####6     | 118M/251M [00:16<00:19, 7.18MB/s]     47%|####7     | 119M/251M [00:16<00:19, 7.21MB/s]     48%|####7     | 120M/251M [00:16<00:18, 7.43MB/s]     48%|####7     | 120M/251M [00:16<00:18, 7.46MB/s]     48%|####8     | 121M/251M [00:16<00:17, 7.82MB/s]     49%|####8     | 122M/251M [00:17<00:16, 8.46MB/s]     49%|####8     | 123M/251M [00:17<00:15, 8.43MB/s]     49%|####9     | 124M/251M [00:17<00:16, 8.25MB/s]     50%|####9     | 125M/251M [00:17<00:15, 8.57MB/s]     50%|####9     | 126M/251M [00:17<00:15, 8.67MB/s]     50%|#####     | 126M/251M [00:17<00:15, 8.66MB/s]     51%|#####     | 127M/251M [00:17<00:15, 8.56MB/s]     51%|#####     | 128M/251M [00:17<00:14, 8.64MB/s]     51%|#####1    | 129M/251M [00:17<00:14, 8.60MB/s]     52%|#####1    | 130M/251M [00:17<00:14, 8.69MB/s]     52%|#####1    | 131M/251M [00:18<00:14, 8.61MB/s]     52%|#####2    | 131M/251M [00:18<00:15, 8.29MB/s]     53%|#####2    | 132M/251M [00:18<00:15, 7.95MB/s]     53%|#####2    | 133M/251M [00:18<00:15, 7.96MB/s]     53%|#####3    | 133M/251M [00:18<00:16, 7.70MB/s]     53%|#####3    | 134M/251M [00:18<00:15, 7.94MB/s]     54%|#####3    | 135M/251M [00:18<00:14, 8.43MB/s]     54%|#####4    | 136M/251M [00:18<00:14, 8.21MB/s]     54%|#####4    | 137M/251M [00:18<00:15, 7.98MB/s]     55%|#####4    | 138M/251M [00:18<00:14, 8.34MB/s]     55%|#####5    | 139M/251M [00:19<00:13, 8.62MB/s]     55%|#####5    | 139M/251M [00:19<00:13, 8.76MB/s]     56%|#####5    | 140M/251M [00:19<00:13, 8.58MB/s]     56%|#####6    | 141M/251M [00:19<00:12, 9.08MB/s]     57%|#####6    | 142M/251M [00:19<00:12, 9.13MB/s]     57%|#####6    | 143M/251M [00:19<00:12, 8.95MB/s]     57%|#####7    | 144M/251M [00:19<00:14, 7.92MB/s]     57%|#####7    | 144M/251M [00:19<00:14, 8.00MB/s]     58%|#####7    | 145M/251M [00:19<00:14, 7.88MB/s]     58%|#####8    | 146M/251M [00:19<00:13, 7.90MB/s]     58%|#####8    | 147M/251M [00:20<00:13, 8.13MB/s]     59%|#####8    | 147M/251M [00:20<00:13, 8.00MB/s]     59%|#####8    | 148M/251M [00:20<00:13, 7.89MB/s]     59%|#####9    | 149M/251M [00:20<00:13, 8.08MB/s]     59%|#####9    | 149M/251M [00:20<00:15, 6.93MB/s]     60%|#####9    | 150M/251M [00:20<00:15, 6.96MB/s]     60%|#####9    | 151M/251M [00:20<00:16, 6.21MB/s]     60%|######    | 151M/251M [00:20<00:18, 5.76MB/s]     60%|######    | 152M/251M [00:20<00:18, 5.56MB/s]     61%|######    | 152M/251M [00:21<00:18, 5.57MB/s]     61%|######    | 153M/251M [00:21<00:17, 5.85MB/s]     61%|######1   | 153M/251M [00:21<00:16, 6.37MB/s]     61%|######1   | 154M/251M [00:21<00:15, 6.69MB/s]     62%|######1   | 155M/251M [00:21<00:15, 6.34MB/s]     62%|######1   | 155M/251M [00:21<00:16, 5.94MB/s]     62%|######2   | 156M/251M [00:21<00:16, 6.17MB/s]     62%|######2   | 157M/251M [00:21<00:15, 6.23MB/s]     63%|######2   | 157M/251M [00:21<00:15, 6.41MB/s]     63%|######2   | 158M/251M [00:21<00:14, 6.72MB/s]     63%|######3   | 159M/251M [00:22<00:14, 6.56MB/s]     63%|######3   | 159M/251M [00:22<00:14, 6.74MB/s]     64%|######3   | 160M/251M [00:22<00:13, 7.07MB/s]     64%|######3   | 160M/251M [00:22<00:14, 6.48MB/s]     64%|######4   | 161M/251M [00:22<00:14, 6.59MB/s]     64%|######4   | 162M/251M [00:22<00:15, 6.17MB/s]     65%|######4   | 162M/251M [00:22<00:15, 5.95MB/s]     65%|######4   | 163M/251M [00:22<00:15, 5.90MB/s]     65%|######5   | 163M/251M [00:22<00:15, 5.94MB/s]     65%|######5   | 164M/251M [00:22<00:15, 5.75MB/s]     65%|######5   | 165M/251M [00:23<00:15, 6.03MB/s]     66%|######5   | 165M/251M [00:23<00:14, 6.40MB/s]     66%|######5   | 166M/251M [00:23<00:14, 6.14MB/s]     66%|######6   | 166M/251M [00:23<00:13, 6.41MB/s]     66%|######6   | 167M/251M [00:23<00:14, 6.19MB/s]     67%|######6   | 167M/251M [00:23<00:15, 5.73MB/s]     67%|######6   | 168M/251M [00:23<00:15, 5.70MB/s]     67%|######7   | 169M/251M [00:23<00:14, 5.98MB/s]     67%|######7   | 169M/251M [00:23<00:14, 6.05MB/s]     68%|######7   | 170M/251M [00:23<00:13, 6.51MB/s]     68%|######7   | 171M/251M [00:24<00:13, 6.41MB/s]     68%|######8   | 171M/251M [00:24<00:13, 6.26MB/s]     68%|######8   | 172M/251M [00:24<00:12, 6.67MB/s]     69%|######8   | 173M/251M [00:24<00:11, 6.91MB/s]     69%|######8   | 173M/251M [00:24<00:11, 6.84MB/s]     69%|######9   | 174M/251M [00:24<00:11, 7.01MB/s]     70%|######9   | 175M/251M [00:24<00:11, 6.94MB/s]     70%|######9   | 175M/251M [00:24<00:11, 6.88MB/s]     70%|#######   | 176M/251M [00:24<00:12, 6.51MB/s]     70%|#######   | 177M/251M [00:25<00:11, 6.83MB/s]     71%|#######   | 177M/251M [00:25<00:11, 6.73MB/s]     71%|#######   | 178M/251M [00:25<00:12, 6.20MB/s]     71%|#######1  | 178M/251M [00:25<00:12, 6.10MB/s]     71%|#######1  | 179M/251M [00:25<00:12, 6.19MB/s]     71%|#######1  | 180M/251M [00:25<00:12, 6.11MB/s]     72%|#######1  | 180M/251M [00:25<00:12, 5.98MB/s]     72%|#######1  | 181M/251M [00:25<00:12, 5.71MB/s]     72%|#######2  | 181M/251M [00:25<00:14, 5.13MB/s]     72%|#######2  | 181M/251M [00:25<00:17, 4.16MB/s]     72%|#######2  | 182M/251M [00:26<00:14, 4.86MB/s]     73%|#######2  | 183M/251M [00:26<00:13, 5.51MB/s]     73%|#######2  | 183M/251M [00:26<00:12, 5.62MB/s]     73%|#######3  | 184M/251M [00:26<00:12, 5.79MB/s]     73%|#######3  | 185M/251M [00:26<00:11, 6.09MB/s]     74%|#######3  | 185M/251M [00:26<00:10, 6.46MB/s]     74%|#######3  | 186M/251M [00:26<00:10, 6.74MB/s]     74%|#######4  | 186M/251M [00:26<00:11, 6.18MB/s]     74%|#######4  | 187M/251M [00:26<00:11, 5.94MB/s]     75%|#######4  | 187M/251M [00:26<00:11, 5.77MB/s]     75%|#######4  | 188M/251M [00:27<00:11, 5.70MB/s]     75%|#######5  | 189M/251M [00:27<00:11, 5.95MB/s]     75%|#######5  | 189M/251M [00:27<00:09, 6.70MB/s]     76%|#######5  | 190M/251M [00:27<00:09, 7.05MB/s]     76%|#######5  | 191M/251M [00:27<00:08, 7.28MB/s]     76%|#######6  | 192M/251M [00:27<00:08, 7.54MB/s]     77%|#######6  | 192M/251M [00:27<00:08, 7.38MB/s]     77%|#######6  | 193M/251M [00:27<00:07, 7.76MB/s]     77%|#######7  | 194M/251M [00:27<00:07, 8.23MB/s]     78%|#######7  | 195M/251M [00:28<00:06, 8.55MB/s]     78%|#######7  | 196M/251M [00:28<00:07, 7.87MB/s]     78%|#######8  | 197M/251M [00:28<00:06, 8.57MB/s]     79%|#######8  | 198M/251M [00:28<00:05, 9.42MB/s]     79%|#######9  | 199M/251M [00:28<00:05, 9.67MB/s]     79%|#######9  | 199M/251M [00:28<00:06, 8.95MB/s]     80%|#######9  | 200M/251M [00:28<00:06, 8.67MB/s]     80%|########  | 201M/251M [00:28<00:06, 8.68MB/s]     80%|########  | 202M/251M [00:28<00:06, 8.15MB/s]     81%|########  | 202M/251M [00:28<00:06, 7.72MB/s]     81%|########  | 203M/251M [00:29<00:06, 7.95MB/s]     81%|########1 | 204M/251M [00:29<00:06, 7.99MB/s]     82%|########1 | 205M/251M [00:29<00:05, 8.23MB/s]     82%|########1 | 206M/251M [00:29<00:05, 8.70MB/s]     82%|########2 | 207M/251M [00:29<00:05, 9.10MB/s]     83%|########2 | 208M/251M [00:29<00:04, 9.19MB/s]     83%|########3 | 209M/251M [00:29<00:06, 6.94MB/s]     84%|########3 | 211M/251M [00:29<00:04, 10.1MB/s]     84%|########4 | 212M/251M [00:29<00:04, 10.3MB/s]     85%|########4 | 213M/251M [00:30<00:04, 9.47MB/s]     85%|########5 | 214M/251M [00:30<00:03, 9.94MB/s]     85%|########5 | 215M/251M [00:30<00:03, 9.87MB/s]     86%|########5 | 215M/251M [00:30<00:04, 9.21MB/s]     86%|########6 | 216M/251M [00:30<00:04, 8.97MB/s]     86%|########6 | 217M/251M [00:30<00:03, 9.26MB/s]     87%|########6 | 218M/251M [00:30<00:04, 8.17MB/s]     87%|########7 | 219M/251M [00:30<00:04, 8.28MB/s]     87%|########7 | 220M/251M [00:30<00:03, 8.69MB/s]     88%|########7 | 220M/251M [00:31<00:03, 8.71MB/s]     88%|########8 | 222M/251M [00:31<00:03, 9.30MB/s]     89%|########8 | 223M/251M [00:31<00:03, 9.74MB/s]     89%|########8 | 224M/251M [00:31<00:02, 10.2MB/s]     89%|########9 | 225M/251M [00:31<00:03, 7.87MB/s]     90%|######### | 227M/251M [00:31<00:02, 11.2MB/s]     91%|######### | 228M/251M [00:31<00:02, 11.2MB/s]     91%|######### | 229M/251M [00:31<00:02, 11.1MB/s]     91%|#########1| 229M/251M [00:32<00:02, 8.57MB/s]     92%|#########1| 231M/251M [00:32<00:02, 9.21MB/s]     92%|#########2| 232M/251M [00:32<00:02, 9.51MB/s]     93%|#########2| 233M/251M [00:32<00:01, 9.94MB/s]     93%|#########2| 234M/251M [00:32<00:01, 10.1MB/s]     93%|#########3| 235M/251M [00:32<00:01, 10.3MB/s]     94%|#########3| 236M/251M [00:32<00:01, 10.4MB/s]     94%|#########4| 237M/251M [00:32<00:01, 10.7MB/s]     95%|#########4| 238M/251M [00:32<00:01, 10.7MB/s]     95%|#########5| 239M/251M [00:32<00:01, 10.8MB/s]     96%|#########5| 240M/251M [00:33<00:01, 11.1MB/s]     96%|#########5| 241M/251M [00:33<00:00, 10.9MB/s]     96%|#########6| 242M/251M [00:33<00:00, 10.7MB/s]     97%|#########6| 243M/251M [00:33<00:00, 10.3MB/s]     97%|#########7| 244M/251M [00:33<00:00, 8.49MB/s]     98%|#########7| 245M/251M [00:33<00:00, 11.1MB/s]     98%|#########8| 246M/251M [00:33<00:00, 10.3MB/s]     98%|#########8| 247M/251M [00:33<00:00, 9.54MB/s]     99%|#########8| 248M/251M [00:33<00:00, 9.46MB/s]     99%|#########9| 249M/251M [00:33<00:00, 9.52MB/s]     99%|#########9| 250M/251M [00:34<00:00, 9.01MB/s]    100%|#########9| 251M/251M [00:34<00:00, 8.19MB/s]    100%|#########9| 251M/251M [00:34<00:00, 7.76MB/s]    100%|##########| 251M/251M [00:34<00:00, 7.68MB/s]

    AnnData object with n_obs × n_vars = 41786 × 4000
        obs: 'barcode', 'x', 'y', 'n_genes_by_counts', 'log1p_n_genes_by_counts', 'total_counts', 'log1p_total_counts', 'pct_counts_in_top_50_genes', 'pct_counts_in_top_100_genes', 'pct_counts_in_top_200_genes', 'pct_counts_in_top_500_genes', 'total_counts_MT', 'log1p_total_counts_MT', 'pct_counts_MT', 'n_counts', 'leiden', 'cluster'
        var: 'MT', 'n_cells_by_counts', 'mean_counts', 'log1p_mean_counts', 'pct_dropout_by_counts', 'total_counts', 'log1p_total_counts', 'n_cells', 'highly_variable', 'highly_variable_rank', 'means', 'variances', 'variances_norm'
        uns: 'cluster_colors', 'hvg', 'leiden', 'leiden_colors', 'neighbors', 'pca', 'spatial_neighbors', 'umap'
        obsm: 'X_pca', 'X_umap', 'deconvolution_results', 'spatial'
        varm: 'PCs'
        obsp: 'connectivities', 'distances', 'spatial_connectivities', 'spatial_distances'



.. GENERATED FROM PYTHON SOURCE LINES 24-26

We can compute the Ripley's L function with :func:`squidpy.gr.ripley`.
Results can be visualized with :func:`squidpy.pl.ripley`.

.. GENERATED FROM PYTHON SOURCE LINES 26-30

.. code-block:: default

    mode = "L"
    sq.gr.ripley(adata, cluster_key="cluster", mode=mode)
    sq.pl.ripley(adata, cluster_key="cluster", mode=mode)




.. image-sg:: /auto_examples/graph/images/sphx_glr_compute_ripley_001.png
   :alt: Ripley's L
   :srcset: /auto_examples/graph/images/sphx_glr_compute_ripley_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /Users/giovanni.palla/Projects/squidpy/squidpy/pl/_graph.py:317: FutureWarning: 

    The `ci` parameter is deprecated. Use `errorbar='sd'` for the same effect.

      sns.lineplot(y="stats", x="bins", ci="sd", alpha=0.01, color="gray", data=res["sims_stat"], ax=ax)




.. GENERATED FROM PYTHON SOURCE LINES 31-33

We can further visualize tissue organization in spatial coordinates
with :func:`squidpy.pl.spatial_scatter`.

.. GENERATED FROM PYTHON SOURCE LINES 33-35

.. code-block:: default

    sq.pl.spatial_scatter(adata, color="cluster", size=20, shape=None)




.. image-sg:: /auto_examples/graph/images/sphx_glr_compute_ripley_002.png
   :alt: cluster
   :srcset: /auto_examples/graph/images/sphx_glr_compute_ripley_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 36-38

There are also 2 other Ripley's statistics available (that are closely related):
``mode = 'F'`` and ``mode = 'G'``.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  13.388 seconds)


.. _sphx_glr_download_auto_examples_graph_compute_ripley.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: compute_ripley.py <compute_ripley.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: compute_ripley.ipynb <compute_ripley.ipynb>`
