
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/graph/compute_nhood_enrichment.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

  .. container:: binder-badge

    .. image:: images/binder_badge_logo.svg
      :target: https://mybinder.org/v2/gh/scverse/squidpy_notebooks/main?filepath=docs/source/auto_examples/graph/compute_nhood_enrichment.ipynb
      :alt: Launch binder
      :width: 150 px

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_graph_compute_nhood_enrichment.py:

Neighbors enrichment analysis
-----------------------------

This example shows how to run the neighbors enrichment analysis routine.

It calculates an enrichment score based on proximity on the connectivity graph of cell clusters.
The number of observed events is compared against :math:`N` permutations and a *z-score* is computed.

:::{seealso}

    See {doc}`sphx_glr_auto_examples_graph_compute_spatial_neighbors.py` for general usage of
    {func}`squidpy.gr.spatial_neighbors`.

.. GENERATED FROM PYTHON SOURCE LINES 16-22

.. code-block:: default


    import squidpy as sq

    adata = sq.datasets.visium_fluo_adata()
    adata





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


      0%|          | 0.00/242M [00:00<?, ?B/s]
      0%|          | 112k/242M [00:00<03:54, 1.08MB/s]
      0%|          | 352k/242M [00:00<02:19, 1.82MB/s]
      0%|          | 832k/242M [00:00<01:19, 3.18MB/s]
      1%|          | 1.72M/242M [00:00<00:45, 5.56MB/s]
      1%|1         | 2.63M/242M [00:00<00:36, 6.98MB/s]
      1%|1         | 3.52M/242M [00:00<00:32, 7.74MB/s]
      2%|1         | 4.60M/242M [00:00<00:28, 8.88MB/s]
      2%|2         | 5.54M/242M [00:00<00:27, 9.15MB/s]
      3%|2         | 6.59M/242M [00:00<00:25, 9.67MB/s]
      3%|3         | 7.46M/242M [00:01<00:25, 9.50MB/s]
      3%|3         | 8.23M/242M [00:01<00:27, 9.01MB/s]
      4%|3         | 9.13M/242M [00:01<00:26, 9.13MB/s]
      4%|4         | 10.1M/242M [00:01<00:25, 9.40MB/s]
      5%|4         | 11.1M/242M [00:01<00:25, 9.65MB/s]
      5%|5         | 12.1M/242M [00:01<00:24, 9.99MB/s]
      5%|5         | 13.3M/242M [00:01<00:22, 10.4MB/s]
      6%|5         | 14.2M/242M [00:01<00:23, 10.3MB/s]
      6%|6         | 15.3M/242M [00:01<00:22, 10.5MB/s]
      7%|6         | 16.3M/242M [00:01<00:23, 10.2MB/s]
      7%|7         | 17.3M/242M [00:02<00:23, 10.2MB/s]
      8%|7         | 18.2M/242M [00:02<00:23, 10.1MB/s]
      8%|7         | 19.0M/242M [00:02<00:25, 9.26MB/s]
      8%|8         | 20.0M/242M [00:02<00:24, 9.55MB/s]
      9%|8         | 20.8M/242M [00:02<00:24, 9.34MB/s]
      9%|9         | 21.8M/242M [00:02<00:24, 9.54MB/s]
      9%|9         | 22.6M/242M [00:02<00:25, 9.19MB/s]
     10%|9         | 23.5M/242M [00:02<00:24, 9.23MB/s]
     10%|9         | 23.8M/242M [00:03<00:58, 3.95MB/s]
     11%|#         | 26.1M/242M [00:03<00:29, 7.68MB/s]
     11%|#         | 26.4M/242M [00:03<00:37, 6.04MB/s]
     12%|#1        | 28.0M/242M [00:03<00:26, 8.35MB/s]{func}
     12%|#1        | 28.9M/242M [00:03<00:26, 8.51MB/s]
     12%|#2        | 29.7M/242M [00:03<00:27, 8.22MB/s]
     13%|#2        | 30.5M/242M [00:03<00:27, 8.06MB/s]
     13%|#2        | 31.2M/242M [00:03<00:27, 7.93MB/s]
     13%|#3        | 32.2M/242M [00:04<00:25, 8.58MB/s]
     14%|#3        | 33.2M/242M [00:04<00:24, 8.97MB/s]
     14%|#4        | 34.1M/242M [00:04<00:23, 9.17MB/s]
     14%|#4        | 35.1M/242M [00:04<00:23, 9.42MB/s]
     15%|#4        | 36.0M/242M [00:04<00:23, 9.33MB/s]
     15%|#5        | 36.9M/242M [00:04<00:22, 9.44MB/s]
     16%|#5        | 37.8M/242M [00:04<00:22, 9.34MB/s]
     16%|#5        | 38.7M/242M [00:04<00:24, 8.83MB/s]
     16%|#6        | 39.7M/242M [00:04<00:22, 9.40MB/s]
     17%|#6        | 40.0M/242M [00:04<00:30, 6.94MB/s]
     17%|#6        | 40.9M/242M [00:05<00:31, 6.79MB/s]
     17%|#7        | 41.9M/242M [00:05<00:26, 7.79MB/s]
     18%|#7        | 43.0M/242M [00:05<00:24, 8.70MB/s]
     18%|#8        | 43.7M/242M [00:05<00:24, 8.42MB/s]
     18%|#8        | 44.6M/242M [00:05<00:24, 8.60MB/s]
     19%|#8        | 45.6M/242M [00:05<00:22, 9.03MB/s]
     19%|#9        | 46.5M/242M [00:05<00:22, 9.25MB/s]
     20%|#9        | 47.4M/242M [00:05<00:22, 9.11MB/s]
     20%|#9        | 48.2M/242M [00:05<00:22, 9.09MB/s]
     20%|##        | 49.1M/242M [00:06<00:22, 9.20MB/s]
     21%|##        | 50.1M/242M{func}6<00:21, 9.28MB/s]
     21%|##1       | 51.0M/242M [00:06<00:21, 9.34MB/s]
     22%|##1       | 52.1M/242M [00:06<00:20, 9.67MB/s]
     22%|##1       | 52.7M/242M [00:06<00:22, 8.64MB/s]
     22%|##2       | 53.7M/242M [00:06<00:21, 9.22MB/s]
     23%|##2       | 54.6M/242M [00:06<00:21, 9.26MB/s]
     23%|##3       | 55.7M/242M [00:06<00:19, 9.83MB/s]
     23%|##3       | 56.5M/242M [00:06<00:20, 9.40MB/s]
     24%|##3       | 57.6M/242M [00:06<00:20, 9.46MB/s]
     24%|##4       | 58.7M/242M [00:07<00:19, 9.98MB/s]
     25%|##4       | 59.5M/242M [00:07<00:20, 9.44MB/s]
     25%|##4       | 60.4M/242M [00:07<00:19, 9.62MB/s]
     25%|##5       | 61.4M/242M [00:07<00:19, 9.80MB/s]
     26%|##5       | 62.4M/242M [00:07<00:19, 9.83MB/s]
     26%|##6       | 63.4M/242M [00:07<00:18, 10.0MB/s]
     27%|##6       | 64.5M/242M [00:07<00:17, 10.5MB/s]
     27%|##7       | 65.4M/242M [00:07<00:18, 10.3MB/s]
     27%|##7       | 66.4M/242M [00:07<00:18, 10.2MB/s]
     28%|##7       | 67.1M/242M [00:07<00:19, 9.39MB/s]
     28%|##7       | 67.7M/242M [00:08<00:23, 7.85MB/s]
     29%|##8       | 69.1M/242M [00:08<00:18, 9.95MB/s]
     29%|##8       | 70.0M/242M [00:08<00:18, 9.82MB/s]
     29%|##9       | 70.9M/242M [00:08<00:18, 9.49MB/s]
     30%|##9       | 71.7M/242M [00:08<00:19, 9.11MB/s]
     30%|##9       | 72.5M/242M [00:08<00:19, 8.91MB/s]
     30%|###       | 73.3M/242M [00:08<00:20, 8.65MB/s]
     31%|###       | 73.9M/242M [00:08<00:22, 7.94MB/s]
     31%|###       | 74.9M/242M [00:08<00:20, 8.71MB/s]
     31%|###1      | 75.7M/242M [00:09<00:20, 8.50MB/s]
     32%|###1      | 76.5M/242M [00:09<00:20, 8.51MB/s]
     32%|###1      | 77.0M/242M [00:09<00:23, 7.48MB/s]
     32%|###2      | 77.6M/242M [00:09<00:24, 7.15MB/s]
     32%|###2      | 78.6M/242M [00:09<00:21, 7.89MB/s]
     33%|###2      | 79.5M/242M [00:09<00:20, 8.17MB/s]
     33%|###3      | 80.4M/242M [00:09<00:19, 8.58MB/s]
     34%|###3      | 81.3M/242M [00:09<00:19, 8.60MB/s]
     34%|###3      | 82.3M/242M [00:09<00:18, 9.24MB/s]
     34%|###4      | 83.1M/242M [00:09<00:18, 9.02MB/s]
     35%|###4      | 83.9M/242M [00:10<00:19, 8.66MB/s]
     35%|###5      | 84.9M/242M [00:10<00:18, 9.06MB/s]
     35%|###5      | 85.8M/242M [00:10<00:18, 9.03MB/s]
     36%|###5      | 86.8M/242M [00:10<00:17, 9.39MB/s]
     36%|###6      | 87.8M/242M [00:10<00:16, 9.64MB/s]
     37%|###6      | 88.7M/242M [00:10<00:16, 9.67MB/s]
     37%|###7      | 89.7M/242M [00:10<00:16, 9.82MB/s]
     37%|###7      | 90.7M/242M [00:10<00:15, 9.99MB/s]
     38%|###7      | 91.5M/242M [00:10<00:17, 9.23MB/s]
     38%|###8      | 92.4M/242M [00:10<00:17, 9.09MB/s]
     38%|###8      | 93.2M/242M [00:11<00:17, 8.82MB/s]
     39%|###8      | 94.0M/242M [00:11<00:18, 8.62MB/s]
     39%|###9      | 94.9M/242M [00:11<00:17, 8.87MB/s]
     40%|###9      | 95.8M/242M [00:11<00:17, 8.59MB/s]
     40%|####      | 96.9M/242M [00:11<00:16, 9.42MB/s]
     40%|####      | 97.6M/242M [00:11<00:17, 8.70MB/s]
     41%|####      | 98.4M/242M [00:11<00:17, 8.79MB/s]
     41%|####      | 98.8M/242M [00:11<00:20, 7.33MB/s]
     41%|####1     | 99.4M/242M [00:11<00:22, 6.65MB/s]
     41%|####1     | 100M/242M [00:12<00:19, 7.49MB/s] 
     42%|####1     | 101M/242M [00:12<00:18, 7.97MB/s]
     42%|####2     | 102M/242M [00:12<00:17, 8.49MB/s]
     42%|####2     | 103M/242M [00:12<00:18, 7.91MB/s]
     43%|####2     | 104M/242M [00:12<00:16, 8.59MB/s]
     43%|####3     | 105M/242M [00:12<00:16, 8.61MB/s]
     44%|####3     | 105M/242M [00:12<00:16, 8.50MB/s]
     44%|####3     | 106M/242M [00:12<00:16, 8.68MB/s]
     44%|####4     | 107M/242M [00:12<00:15, 8.89MB/s]
     45%|####4     | 108M/242M [00:12<00:15, 9.34MB/s]
     45%|####5     | 109M/242M [00:13<00:14, 9.38MB/s]
     45%|####5     | 110M/242M [00:13<00:15, 9.05MB/s]
     46%|####5     | 111M/242M [00:13<00:15, 8.98MB/s]
     46%|####6     | 112M/242M [00:13<00:15, 8.76MB/s]
     46%|####6     | 113M/242M [00:13<00:15, 8.82MB/s]
     47%|####6     | 113M/242M [00:13<00:14, 9.02MB/s]
     47%|####7     | 114M/242M [00:13<00:14, 9.15MB/s]
     48%|####7     | 115M/242M [00:13<00:14, 9.13MB/s]
     48%|####7     | 116M/242M [00:13<00:14, 9.10MB/s]
     48%|####8     | 117M/242M [00:13<00:14, 8.83MB/s]
     49%|####8     | 118M/242M [00:14<00:15, 8.44MB/s]
     49%|####8     | 118M/242M [00:14<00:15, 8.36MB/s]
     49%|####9     | 119M/242M [00:14<00:15, 8.26MB/s]
     50%|####9     | 120M/242M [00:14<00:15, 8.48MB/s]
     50%|####9     | 121M/242M [00:14<00:15, 7.99MB/s]
     50%|#####     | 122M/242M [00:14<00:15, 8.04MB/s]
     51%|#####     | 122M/242M [00:14<00:15, 8.02MB/s]
     51%|#####     | 123M/242M [00:14<00:15, 8.26MB/s]
     51%|#####1    | 124M/242M [00:14<00:15, 8.11MB/s]
     52%|#####1    | 125M/242M [00:15<00:14, 8.22MB/s]
     52%|#####1    | 126M/242M [00:15<00:14, 8.41MB/s]
     52%|#####2    | 127M/242M [00:15<00:14, 8.38MB/s]
     53%|#####2    | 128M/242M [00:15<00:13, 8.87MB/s]
     53%|#####3    | 128M/242M [00:15<00:13, 8.80MB/s]
     53%|#####3    | 129M/242M [00:15<00:14, 8.37MB/s]
     54%|#####3    | 130M/242M [00:15<00:14, 8.29MB/s]
     54%|#####3    | 131M/242M [00:15<00:14, 8.00MB/s]
     54%|#####4    | 132M/242M [00:15<00:14, 8.10MB/s]
     55%|#####4    | 132M/242M [00:15<00:13, 8.28MB/s]
     55%|#####5    | 133M/242M [00:16<00:13, 8.71MB/s]
     55%|#####5    | 134M/242M [00:16<00:12, 8.96MB/s]
     56%|#####5    | 135M/242M [00:16<00:13, 8.33MB/s]
     56%|#####5    | 135M/242M [00:16<00:16, 6.72MB/s]
     57%|#####6    | 137M/242M [00:16<00:11, 9.21MB/s]
     57%|#####6    | 138M/242M [00:16<00:13, 8.24MB/s]
     57%|#####7    | 138M/242M [00:16<00:12, 8.59MB/s]
     57%|#####7    | 139M/242M [00:16<00:13, 7.85MB/s]
     58%|#####7    | 140M/242M [00:16<00:13, 7.92MB/s]
     58%|#####8    | 141M/242M [00:17<00:14, 7.52MB/s]
     58%|#####8    | 141M/242M [00:17<00:13, 7.74MB/s]
     59%|#####8    | 142M/242M [00:17<00:13, 8.00MB/s]
     59%|#####8    | 143M/242M [00:17<00:14, 7.34MB/s]
     59%|#####9    | 143M/242M [00:17<00:14, 7.01MB/s]
     59%|#####9    | 144M/242M [00:17<00:14, 6.91MB/s]
     60%|#####9    | 145M/242M [00:17<00:14, 7.25MB/s]
     60%|######    | 146M/242M [00:17<00:12, 7.91MB/s]
     61%|######    | 147M/242M [00:17<00:12, 8.11MB/s]
     61%|######    | 147M/242M [00:17<00:12, 7.99MB/s]
     61%|######1   | 148M/242M [00:18<00:12, 8.09MB/s]
     61%|######1   | 149M/242M [00:18<00:11, 8.22MB/s]
     62%|######1   | 150M/242M [00:18<00:11, 8.63MB/s]
     62%|######2   | 151M/242M [00:18<00:10, 8.96MB/s]
     63%|######2   | 152M/242M [00:18<00:10, 8.97MB/s]
     63%|######2   | 153M/242M [00:18<00:10, 9.07MB/s]
     63%|######3   | 153M/242M [00:18<00:10, 9.29MB/s]
     63%|######3   | 154M/242M [00:18<00:13, 6.75MB/s]
     64%|######3   | 154M/242M [00:18<00:12, 7.34MB/s]
     64%|######4   | 155M/242M [00:18<00:12, 7.41MB/s]
     64%|######4   | 156M/242M [00:19<00:11, 7.87MB/s]
     65%|######4   | 157M/242M [00:19<00:10, 8.50MB/s]
     65%|######5   | 158M/242M [00:19<00:11, 7.81MB/s]
     66%|######5   | 159M/242M [00:19<00:10, 8.53MB/s]
     66%|######5   | 159M/242M [00:19<00:11, 7.78MB/s]
     66%|######6   | 160M/242M [00:19<00:10, 8.35MB/s]
     66%|######6   | 161M/242M [00:19<00:11, 7.71MB/s]
     67%|######6   | 162M/242M [00:19<00:10, 8.05MB/s]
     67%|######6   | 162M/242M [00:19<00:11, 7.56MB/s]
     67%|######7   | 163M/242M [00:19<00:10, 7.99MB/s]
     68%|######7   | 164M/242M [00:20<00:10, 8.13MB/s]
     68%|######8   | 165M/242M [00:20<00:09, 8.67MB/s]
     68%|######8   | 166M/242M [00:20<00:09, 8.75MB/s]
     69%|######8   | 167M/242M [00:20<00:09, 8.72MB/s]
     69%|######9   | 168M/242M [00:20<00:08, 9.12MB/s]
     70%|######9   | 168M/242M [00:20<00:08, 8.74MB/s]
     70%|######9   | 169M/242M [00:20<00:08, 9.08MB/s]
     70%|#######   | 170M/242M [00:20<00:08, 9.09MB/s]
     71%|#######   | 171M/242M [00:20<00:08, 8.96MB/s]
     71%|#######1  | 172M/242M [00:20<00:07, 9.40MB/s]
     71%|#######1  | 173M/242M [00:21<00:07, 9.15MB/s]
     72%|#######1  | 174M/242M [00:21<00:07, 9.50MB/s]
     72%|#######2  | 175M/242M [00:21<00:07, 9.42MB/s]
     73%|#######2  | 176M/242M [00:21<00:07, 9.59MB/s]
     73%|#######2  | 177M/242M [00:21<00:07, 9.65MB/s]
     73%|#######3  | 178M/242M [00:21<00:06, 9.85MB/s]
     74%|#######3  | 179M/242M [00:21<00:06, 9.59MB/s]
     74%|#######4  | 179M/242M [00:21<00:07, 9.00MB/s]
     74%|#######4  | 180M/242M [00:21<00:07, 8.45MB/s]
     75%|#######4  | 181M/242M [00:22<00:07, 8.30MB/s]
     75%|#######4  | 182M/242M [00:22<00:07, 8.35MB/s]
     75%|#######5  | 182M/242M [00:22<00:07, 7.99MB/s]
     76%|#######5  | 183M/242M [00:22<00:06, 9.05MB/s]
     76%|#######6  | 184M/242M [00:22<00:06, 9.27MB/s]
     77%|#######6  | 185M/242M [00:22<00:06, 9.58MB/s]
     77%|#######6  | 186M/242M [00:22<00:06, 9.55MB/s]
     77%|#######7  | 187M/242M [00:22<00:06, 9.20MB/s]
     78%|#######7  | 188M/242M [00:22<00:06, 9.17MB/s]
     78%|#######8  | 189M/242M [00:22<00:05, 9.44MB/s]
     78%|#######8  | 190M/242M [00:23<00:05, 9.42MB/s]
     79%|#######8  | 191M/242M [00:23<00:05, 9.34MB/s]
     79%|#######9  | 192M/242M [00:23<00:05, 9.33MB/s]
     80%|#######9  | 193M/242M [00:23<00:05, 8.92MB/s]
     80%|#######9  | 193M/242M [00:23<00:05, 8.80MB/s]
     80%|########  | 194M/242M [00:23<00:05, 9.27MB/s]
     81%|########  | 195M/242M [00:23<00:05, 8.92MB/s]
     81%|########  | 196M/242M [00:23<00:05, 9.22MB/s]
     81%|########1 | 197M/242M [00:23<00:06, 7.74MB/s]
     82%|########1 | 198M/242M [00:23<00:05, 8.84MB/s]
     82%|########1 | 198M/242M [00:24<00:05, 8.12MB/s]
     82%|########2 | 199M/242M [00:24<00:05, 7.80MB/s]
     83%|########2 | 200M/242M [00:24<00:05, 7.92MB/s]
     83%|########2 | 201M/242M [00:24<00:05, 8.14MB/s]
     83%|########3 | 201M/242M [00:24<00:05, 7.56MB/s]
     84%|########3 | 202M/242M [00:24<00:05, 7.86MB/s]
     84%|########3 | 203M/242M [00:24<00:05, 7.76MB/s]
     84%|########4 | 204M/242M [00:24<00:05, 7.81MB/s]
     84%|########4 | 205M/242M [00:24<00:04, 8.02MB/s]
     85%|########4 | 205M/242M [00:25<00:04, 8.19MB/s]
     85%|########5 | 206M/242M [00:25<00:04, 8.24MB/s]
     85%|########5 | 207M/242M [00:25<00:04, 7.66MB/s]
     86%|########5 | 208M/242M [00:25<00:05, 7.25MB/s]
     86%|########6 | 208M/242M [00:25<00:04, 7.75MB/s]
     86%|########6 | 209M/242M [00:25<00:04, 8.30MB/s]
     87%|########6 | 210M/242M [00:25<00:03, 8.65MB/s]
     87%|########7 | 211M/242M [00:25<00:03, 8.79MB/s]
     87%|########7 | 212M/242M [00:25<00:03, 8.41MB/s]
     88%|########7 | 213M/242M [00:25<00:03, 8.61MB/s]
     88%|########8 | 213M/242M [00:26<00:03, 8.23MB/s]
     88%|########8 | 214M/242M [00:26<00:03, 7.50MB/s]
     89%|########8 | 215M/242M [00:26<00:03, 7.72MB/s]
     89%|########9 | 216M/242M [00:26<00:03, 8.20MB/s]
     89%|########9 | 217M/242M [00:26<00:03, 8.73MB/s]
     90%|########9 | 218M/242M [00:26<00:02, 8.86MB/s]
     90%|######### | 218M/242M [00:26<00:02, 8.71MB/s]
     91%|######### | 219M/242M [00:26<00:02, 8.84MB/s]
     91%|######### | 220M/242M [00:26<00:02, 8.86MB/s]
     91%|#########1| 221M/242M [00:26<00:02, 9.16MB/s]
     92%|#########1| 222M/242M [00:27<00:02, 7.99MB/s]
     92%|#########1| 222M/242M [00:27<00:03, 6.65MB/s]
     92%|#########2| 223M/242M [00:27<00:02, 7.18MB/s]
     92%|#########2| 224M/242M [00:27<00:02, 7.42MB/s]
     93%|#########2| 225M/242M [00:27<00:02, 7.84MB/s]
     93%|#########3| 225M/242M [00:27<00:02, 7.59MB/s]
     93%|#########3| 226M/242M [00:27<00:02, 7.77MB/s]
     94%|#########3| 227M/242M [00:27<00:02, 7.25MB/s]
     94%|#########3| 228M/242M [00:27<00:01, 7.86MB/s]
     94%|#########4| 228M/242M [00:27<00:01, 7.70MB/s]
     95%|#########4| 229M/242M [00:28<00:01, 8.01MB/s]
     95%|#########4| 230M/242M [00:28<00:01, 7.47MB/s]
     95%|#########5| 231M/242M [00:28<00:01, 6.76MB/s]
     96%|#########5| 232M/242M [00:28<00:01, 7.99MB/s]
     96%|#########5| 232M/242M [00:28<00:01, 7.22MB/s]
     96%|#########6| 233M/242M [00:28<00:01, 7.37MB/s]
     97%|#########6| 234M/242M [00:28<00:01, 7.63MB/s]
     97%|#########6| 234M/242M [00:28<00:01, 7.46MB/s]
     97%|#########7| 235M/242M [00:28<00:01, 6.92MB/s]
     97%|#########7| 236M/242M [00:29<00:00, 7.66MB/s]
     98%|#########7| 237M/242M [00:29<00:00, 7.73MB/s]
     98%|#########8| 238M/242M [00:29<00:00, 7.89MB/s]
     98%|#########8| 238M/242M [00:29<00:00, 7.62MB/s]
     99%|#########8| 239M/242M [00:29<00:00, 7.88MB/s]
     99%|#########9| 240M/242M [00:29<00:00, 8.24MB/s]
     99%|#########9| 241M/242M [00:29<00:00, 7.81MB/s]
    100%|#########9| 241M/242M [00:29<00:00, 7.88MB/s]
    100%|#########9| 242M/242M [00:29<00:00, 7.98MB/s]
    100%|##########| 242M/242M [00:29<00:00, 8.49MB/s]

    AnnData object with n_obs × n_vars = 2800 × 16562
        obs: 'in_tissue', 'array_row', 'array_col', 'n_genes_by_counts', 'log1p_n_genes_by_counts', 'total_counts', 'log1p_total_counts', 'pct_counts_in_top_50_genes', 'pct_counts_in_top_100_genes', 'pct_counts_in_top_200_genes', 'pct_counts_in_top_500_genes', 'total_counts_MT', 'log1p_total_counts_MT', 'pct_counts_MT', 'n_counts', 'leiden', 'cluster'
        var: 'gene_ids', 'feature_types', 'genome', 'MT', 'n_cells_by_counts', 'mean_counts', 'log1p_mean_counts', 'pct_dropout_by_counts', 'total_counts', 'log1p_total_counts', 'n_cells', 'highly_variable', 'highly_variable_rank', 'means', 'variances', 'variances_norm'
        uns: 'cluster_colors', 'hvg', 'leiden', 'leiden_colors', 'neighbors', 'pca', 'spatial', 'umap'
        obsm: 'X_pca', 'X_umap', 'spatial'
        varm: 'PCs'
        obsp: 'connectivities', 'distances'



.. GENERATED FROM PYTHON SOURCE LINES 23-25

This dataset contains cell type annotations in {attr}`anndata.Anndata.obs` which are used for calculation of the
neighborhood enrichment. First, we need to compute a connectivity matrix from spatial coordinates.

.. GENERATED FROM PYTHON SOURCE LINES 25-27

.. code-block:: default

    sq.gr.spatial_neighbors(adata)








.. GENERATED FROM PYTHON SOURCE LINES 28-29

Then we can calculate the neighborhood enrichment score with :func:`squidpy.gr.nhood_enrichment`.

.. GENERATED FROM PYTHON SOURCE LINES 29-31

.. code-block:: default

    sq.gr.nhood_enrichment(adata, cluster_key="cluster")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


      0%|          | 0/1000 [00:00<?, ?/s]
      0%|          | 1/1000 [00:15<4:25:57, 15.97s/]
     26%|##6       | 261/1000 [00:16<00:31, 23.11/s]
     52%|#####2    | 525/1000 [00:16<00:08, 55.83/s]
     80%|########  | 802/1000 [00:16<00:01, 103.46/s]
    100%|##########| 1000/1000 [00:16<00:00, 61.19/s]




.. GENERATED FROM PYTHON SOURCE LINES 32-33

And visualize the results with :func:`squidpy.pl.nhood_enrichment`.

.. GENERATED FROM PYTHON SOURCE LINES 33-34

.. code-block:: default

    sq.pl.nhood_enrichment(adata, cluster_key="cluster")



.. image-sg:: /auto_examples/graph/images/sphx_glr_compute_nhood_enrichment_001.png
   :alt: Neighborhood enrichment
   :srcset: /auto_examples/graph/images/sphx_glr_compute_nhood_enrichment_001.png
   {class} sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  1.229 seconds)


.. _sphx_glr_download_auto_examples_graph_compute_nhood_enrichment.py:


.. only :: html

 .. container:: sphx-glr-footer
    {class} sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: compute_nhood_enrichment.py <compute_nhood_enrichment.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: compute_nhood_enrichment.ipynb <compute_nhood_enrichment.ipynb>`
